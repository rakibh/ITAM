<!DOCTYPE html>
<html>
<head>
    <title>Simple Task Test</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body { font-family: Arial; padding: 20px; }
        button { padding: 10px 20px; margin: 5px; font-size: 16px; }
        #output { 
            background: #f4f4f4; 
            padding: 15px; 
            margin-top: 20px; 
            border-radius: 5px;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
        }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Simple Task AJAX Test</h1>
    <p>This tests if AJAX calls to todo_operations.php work correctly.</p>
    
    <button onclick="testGetTasks()">Test Get Tasks</button>
    <button onclick="testDirectURL()">Test Direct URL</button>
    <button onclick="clearOutput()">Clear Output</button>
    
    <div id="output"></div>
    
    <script>
        function log(message, type = 'info') {
            const output = document.getElementById('output');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'success' ? 'green' : type === 'error' ? 'red' : 'black';
            output.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
        }
        
        function clearOutput() {
            document.getElementById('output').innerHTML = '';
        }
        
        function testGetTasks() {
            log('Testing GET tasks via AJAX...');
            
            $.ajax({
                url: '/it-claud/ITAM/ajax/todo_operations.php',
                type: 'GET',
                data: {
                    action: 'get_tasks',
                    tab: 'all'
                },
                dataType: 'json',
                success: function(response) {
                    log('✓ AJAX SUCCESS', 'success');
                    log('Response: ' + JSON.stringify(response, null, 2));
                    
                    if (response.success) {
                        log(`✓ Found ${response.tasks.length} tasks`, 'success');
                        log(`✓ Counts: All=${response.counts.all_count}, Assigned=${response.counts.assigned_count}`, 'success');
                        
                        if (response.tasks.length > 0) {
                            log('First task: ' + JSON.stringify(response.tasks[0], null, 2));
                        }
                    } else {
                        log('✗ Response success=false: ' + response.message, 'error');
                    }
                },
                error: function(xhr, status, error) {
                    log('✗ AJAX ERROR', 'error');
                    log('Status: ' + xhr.status, 'error');
                    log('Error: ' + error, 'error');
                    log('Response Text: ' + xhr.responseText, 'error');
                }
            });
        }
        
        function testDirectURL() {
            log('Opening direct URL in new tab...');
            window.open('/it-claud/ITAM/ajax/todo_operations.php?action=get_tasks&tab=all', '_blank');
            log('Check the new tab for JSON response');
        }
    </script>
</body>
</html>